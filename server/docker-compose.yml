mysql:
  image: mysql:5.7.17
  volumes:
    - /home/ds/tc10/mysql/data:/var/lib/mysql
  environment:
    - MYSQL_ROOT_PASSWORD=Proper123
    - MYSQL_DATABASE=pep
    - MYSQL_USER=pep
    - MYSQL_PASSWORD=pep
  command: --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci

teamcity:
  image: jetbrains/teamcity-server:10.0.4
  links: 
    - mysql
  volumes:
    - /etc/localtime:/etc/localtime:ro
    - /home/ds/tc10/teamcity/data:/data/teamcity_server/datadir
    - /home/ds/tc10/teamcity/logs:/opt/teamcity/logs
    - ./server.xml:/opt/teamcity/conf/server.xml
    - ./entrypoint.sh:/entrypoint.sh
  environment:
    - TEAMCITY_CONTEXT=teamcity
    - TEAMCITY_DATA_PATH=/data/teamcity_server/datadir
    - TEAMCITY_SERVER_MEM_OPTS=-Xmx2g -XX:MaxPermSize=270m -XX:ReservedCodeCacheSize=350m
  entrypoint: /entrypoint.sh
  ports:
    - "8111:8111"